<template>
    <div class="waiter-review">
        <div class="waiter-review__title">
            {{ $t('rate_waiter') }}
        </div>
        <div class="waiter-review__rating">
            <div class="rating-item rating-item--badly"
                 :class="{active: reviewRating === 'badly'}"
                 @click="reviewRating = 'badly'"
            >
                <img src="/src/assets/images/emoji/badly.png">
                <span>{{ $t('bad') }}</span>
            </div>
            <div class="rating-item rating-item--fine"
                 :class="{active: reviewRating === 'fine'}"
                 @click="reviewRating = 'fine'"
            >
                <img src="/src/assets/images/emoji/fine.png">
                <span>{{ $t('normal') }}</span>
            </div>
            <div class="rating-item rating-item--great"
                 :class="{active: reviewRating === 'great'}"
                 @click="reviewRating = 'great'"
            >
                <img src="/src/assets/images/emoji/great.png">
                <span>{{ $t('great') }}</span>
            </div>
        </div>
        <div class="waiter-review__textarea" :class="{active: isTextareaOpen}">
            <textarea placeholder="Напишите отзыв" v-model="review"></textarea>
            <div class="waiter-review__prompt">
                {{ $t('leave_your_phone') }}
            </div>
        </div>
        <div class="waiter-review__btn btn btn--border" :class="{active: isTextareaOpen}" @click="addReview">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path opacity="0.12" d="M17 21C13.6863 21 11 18.3137 11 15C11 11.6863 13.6863 9 17 9C20.3137 9 23 11.6863 23 15C23 15.8994 22.8019 16.7526 22.4472 17.5184C22.167 18.1231 21.9019 18.6387 22.0973 19.3186C22.1913 19.6457 22.4268 19.9679 22.4548 20.3085C22.4868 20.698 22.1437 21.0137 21.7582 20.9494C20.9733 20.8186 20.5954 20.1945 19.6847 20.4086C19.586 20.4319 19.3287 20.5239 18.8142 20.7079C18.2699 20.9026 17.6836 21 17 21Z" fill="#D2015F"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M2.75 10.5C2.75 6.21979 6.21979 2.75 10.5 2.75C13.2726 2.75 15.7059 4.20546 17.0765 6.39761C17.2961 6.74882 17.7588 6.85552 18.1101 6.63593C18.4613 6.41634 18.568 5.9536 18.3484 5.60239C16.7151 2.99023 13.8111 1.25 10.5 1.25C5.39137 1.25 1.25 5.39137 1.25 10.5C1.25 11.8853 1.5553 13.2014 2.10266 14.3829L2.11145 14.4019C2.52822 15.3015 2.74338 15.766 2.55804 16.4109L3.27886 16.6181L2.55804 16.4109C2.52215 16.5358 2.46779 16.6536 2.38764 16.8273L2.38763 16.8273L2.38761 16.8274C2.36324 16.8802 2.33648 16.9382 2.30713 17.0031C2.19944 17.2413 2.05615 17.5783 2.02488 17.9589C1.93956 18.9977 2.85435 19.8394 3.88246 19.6682L3.7592 18.9284L3.88246 19.6682C4.44258 19.5748 4.9265 19.3246 5.26584 19.1491L5.26591 19.1491C5.34682 19.1072 5.4195 19.0696 5.48304 19.0394C5.83146 18.8739 6.10656 18.7939 6.525 18.8923L6.5255 18.8925L6.53122 18.8939L6.55004 18.8992C6.56658 18.9041 6.58846 18.9108 6.61679 18.9199C6.67382 18.9382 6.7489 18.9635 6.84652 18.9974C7.042 19.0652 7.31124 19.1615 7.67722 19.2924L7.92983 18.5862L7.67723 19.2924C8.05095 19.4261 8.43657 19.5304 8.84013 19.6054C9.24736 19.6811 9.63887 19.4124 9.71459 19.0052C9.79031 18.5979 9.52156 18.2064 9.11433 18.1307C8.78848 18.0701 8.48016 17.9865 8.18244 17.88L8.06064 17.8365L8.06056 17.8364C7.43899 17.614 7.05064 17.475 6.86839 17.4322C5.99659 17.2271 5.35895 17.4376 4.83919 17.6846C4.69553 17.7529 4.57264 17.8157 4.4617 17.8723L4.46167 17.8724C4.15706 18.0279 3.94258 18.1375 3.63594 18.1886C3.57169 18.1993 3.51452 18.1467 3.51985 18.0817C3.52821 17.9799 3.57159 17.8474 3.67395 17.621C3.6888 17.5881 3.70584 17.5515 3.72433 17.5117L3.72434 17.5117C3.81073 17.326 3.92856 17.0727 3.99969 16.8252C4.34335 15.6294 3.89895 14.6814 3.53625 13.9078L3.5362 13.9077C3.51157 13.8551 3.48732 13.8034 3.46371 13.7524C3.00595 12.7643 2.75 11.663 2.75 10.5ZM17 8.25C13.2721 8.25 10.25 11.2721 10.25 15C10.25 18.7279 13.2721 21.75 17 21.75C17.7583 21.75 18.4313 21.6414 19.0668 21.4141C19.3256 21.3215 19.5145 21.254 19.6512 21.2065C19.7195 21.1828 19.7706 21.1656 19.8085 21.1535C19.8497 21.1403 19.8614 21.1375 19.8565 21.1387C20.0851 21.085 20.226 21.1222 20.4467 21.2271C20.483 21.2443 20.5274 21.2674 20.579 21.2942L20.5791 21.2943C20.8151 21.4168 21.1999 21.6168 21.635 21.6892L21.7582 20.9494L21.635 21.6892C22.5024 21.8338 23.2743 21.1236 23.2023 20.2471C23.1768 19.9374 23.061 19.6694 22.9842 19.4995C22.9604 19.4469 22.9398 19.4022 22.9219 19.3634L22.9215 19.3625C22.8681 19.2467 22.8385 19.1823 22.8181 19.1115C22.7129 18.7453 22.8219 18.4938 23.1277 17.8336C23.5272 16.9711 23.75 16.0106 23.75 15C23.75 11.2721 20.7279 8.25 17 8.25ZM11.75 15C11.75 12.1005 14.1005 9.75 17 9.75C19.8995 9.75 22.25 12.1005 22.25 15C22.25 15.7882 22.0766 16.534 21.7666 17.2031C21.7494 17.2402 21.7315 17.2784 21.713 17.3176C21.4585 17.8588 21.1102 18.5991 21.3764 19.5258C21.4321 19.7193 21.5252 19.9191 21.5856 20.0486L21.5856 20.0487C21.5977 20.0746 21.6085 20.0977 21.6174 20.1174L21.6251 20.1347C21.5533 20.1043 21.4784 20.0661 21.3852 20.0185C21.3042 19.9771 21.2093 19.9287 21.0905 19.8723C20.6985 19.6859 20.1951 19.5182 19.513 19.6786C19.3716 19.7118 19.0868 19.8138 18.6654 19.9646L18.6653 19.9646L18.5616 20.0017C18.1084 20.1638 17.609 20.25 17 20.25C14.1005 20.25 11.75 17.8995 11.75 15Z" fill="#D2015F"/>
            </svg>
            <span>{{ isTextareaOpen ? $t('post_review') : $t('write_review') }}</span>
        </div>
        <transition>
            <div v-if="isSent" class="review-success">
                <div class="review-success__icon">
                    <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M2.41675 15C2.41675 8.05041 8.0505 2.41666 15.0001 2.41666C21.9497 2.41666 27.5834 8.05041 27.5834 15C27.5834 21.9496 21.9497 27.5833 15.0001 27.5833C13.5556 27.5833 12.3396 27.3782 11.2211 26.9781L11.0783 26.927L11.0781 26.9269C10.0586 26.5622 9.46722 26.3506 9.20581 26.2891L9.04341 26.9796L9.2058 26.2891C7.96718 25.9978 7.07004 26.2909 6.30344 26.6552C6.10679 26.7487 5.92923 26.8394 5.76197 26.925C5.26158 27.1808 4.8535 27.3894 4.30302 27.4811C3.92819 27.5436 3.59468 27.2367 3.62578 26.858C3.64542 26.619 3.74187 26.353 3.90395 25.9945C3.93051 25.9357 3.95972 25.8728 3.99047 25.8066L3.99055 25.8064C4.12639 25.5139 4.29237 25.1565 4.39363 24.8041C4.88709 23.087 4.25626 21.7375 3.68278 20.5107C3.6468 20.4337 3.61104 20.3572 3.5758 20.2811C2.83227 18.6761 2.41675 16.8875 2.41675 15ZM15.0001 0.916656C7.22207 0.916656 0.916748 7.22198 0.916748 15C0.916748 17.1098 1.38162 19.1132 2.21475 20.9116L2.2653 21.0207C2.88513 22.3573 3.28701 23.224 2.95198 24.3898L3.45209 24.5335L2.95198 24.3898C2.88594 24.6196 2.78342 24.8415 2.65343 25.1229L2.65342 25.1229C2.61677 25.2022 2.57794 25.2863 2.53712 25.3766C2.36972 25.7469 2.17335 26.2173 2.13082 26.7352C2.01973 28.0878 3.21086 29.1838 4.54953 28.9607L4.42628 28.2209L4.54954 28.9607C5.35324 28.8268 6.03099 28.4775 6.56501 28.2023L6.56504 28.2023L6.56506 28.2023C6.70202 28.1317 6.82953 28.066 6.94729 28.01C7.54255 27.7271 8.07715 27.5646 8.86241 27.7493C9.02771 27.7882 9.53671 27.9686 10.7158 28.3904L10.9684 27.6842L10.7158 28.3904C12.0167 28.8558 13.4063 29.0833 15.0001 29.0833C22.7781 29.0833 29.0834 22.778 29.0834 15C29.0834 7.22198 22.7781 0.916656 15.0001 0.916656ZM20.1971 12.197C20.49 11.9041 20.49 11.4292 20.1971 11.1363C19.9042 10.8434 19.4293 10.8434 19.1364 11.1363L13.6667 16.606L11.5304 14.4697C11.2375 14.1768 10.7626 14.1768 10.4698 14.4697C10.1769 14.7626 10.1769 15.2374 10.4698 15.5303L13.1364 18.197C13.4293 18.4899 13.9042 18.4899 14.1971 18.197L20.1971 12.197Z"
                              fill="#00C600"/>
                    </svg>
                </div>
                <div class="review-success__info">
                    <div class="review-success__title">
                        {{ $t('thanks_for_feedback') }}
                    </div>
                    <div class="review-success__descr">
                        {{ $t('we_make_satisfied') }}
                    </div>
                </div>
            </div>
        </transition>
        <div class="waiter-review__footer">
            {{ $t('go_to_menu_for_review') }}
        </div>
    </div>
</template>

<script>
    import {ref} from 'vue'
    import store from '@/store/store'

    export default {
        components: {},
        setup() {
            const isTextareaOpen = ref(false);
            const review = ref('');
            const reviewRating = ref('great');
            const isSent = ref(false);

            const addReview = () => {
                if(isTextareaOpen.value === true) {
                    sendReview();
                }
                else {
                    isTextareaOpen.value = true;
                }
            }

            const sendReview = () => {
                isSent.value = true;
                /*store.dispatch('catalog/sendReview', {
                    id: props.id,
                    review: review.value,
                    ratingCode: reviewRating.value,
                });*/
                review.value = '';
                setTimeout(() => isSent.value = false, 5000);
            }

            return {
                isTextareaOpen,
                review,
                addReview,
                sendReview,
                reviewRating,
                isSent
            }
        }
    }
</script>

<style lang="scss">

</style>
